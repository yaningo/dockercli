version: 2.1

orbs:
  orb-tools: circleci/orb-tools@11

jobs:
  my_job:
    docker:
      - image: cimg/base:2023.02
    steps:
      - run: |
          echo "<< pipeline.id >>"
          echo "<< pipeline.project.git_url >>"
          echo 'pipeline.git.revision=<<pipeline.git.revision>>' > rev.txt
          # the <<pipeline.git.revision>> value that https://circleci.com/docs/variables/#pipeline-values says we can.
          cat rev.txt
#       - checkout
#       - my-orb/my_command

workflows:
  main:
    jobs:
      - my_job
      - orb-tools/publish:
          name: bla
          orb-name: bla/circleci
          vcs-type: << pipeline.project.type >>
